# =============================================================================
# PATH
# =============================================================================
fish_add_path /opt/homebrew/bin /opt/homebrew/sbin  # Homebrew (Apple Silicon)
fish_add_path $HOME/.bun/bin                         # Bun
fish_add_path $HOME/.deno/bin                        # Deno
fish_add_path $HOME/.cargo/bin                       # Cargo (Rust)
fish_add_path $HOME/zig/zig-0.14.1                   # Zig
fish_add_path /usr/local/go/bin                      # Go
fish_add_path $HOME/go/bin                           # Go binaries
fish_add_path $HOME/.local/bin
fish_add_path $HOME/.spicetify

# =============================================================================
# EDITOR / KEY BINDINGS
# =============================================================================
set -g fish_key_bindings fish_vi_key_bindings

function fish_user_key_bindings
    fish_vi_key_bindings
    bind -M insert \cr history-pager
    bind -M default \cr history-pager
end

# =============================================================================
# THEME
# =============================================================================
fish_config theme choose "ayu Light"

# =============================================================================
# GREETING
# =============================================================================
function fish_greeting
    echo "morning"
end

# =============================================================================
# ALIASES
# =============================================================================
alias ga='git add'
alias ls='eza'
alias cat='bat'
alias grep='rg'

# =============================================================================
# FUNCTIONS
# =============================================================================

# Install missing cargo binaries
function ensure_cargo_bins
    set -l bins_and_crates \
        bat bat \
        rg ripgrep \
        eza eza \
        dust du-dust \
        tokei tokei

    for i in (seq 1 2 (count $bins_and_crates))
        set -l bin $bins_and_crates[$i]
        set -l crate $bins_and_crates[(math $i + 1)]
        if not type -q $bin
            echo "Installing $crate (provides $bin) with cargo..."
            cargo install $crate
        else
            echo "$bin already installed âœ…"
        end
    end
end

# =============================================================================
# THIRD PARTY
# =============================================================================

# opam (OCaml)
test -r '/Users/viktor/.opam/opam-init/init.fish' && source '/Users/viktor/.opam/opam-init/init.fish' > /dev/null 2> /dev/null; or true

# Google Cloud SDK
if [ -f '/Users/viktor/Downloads/google-cloud-sdk/path.fish.inc' ]
    . '/Users/viktor/Downloads/google-cloud-sdk/path.fish.inc'
end
